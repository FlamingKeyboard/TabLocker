/*! For license information please see background.js.LICENSE.txt */
(()=>{var t={992:(t,e,r)=>{var n,o=function(){var t=String.fromCharCode,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",n={};function o(t,e){if(!n[t]){n[t]={};for(var r=0;r<t.length;r++)n[t][t.charAt(r)]=r}return n[t][e]}var a={compressToBase64:function(t){if(null==t)return"";var r=a._compress(t,6,(function(t){return e.charAt(t)}));switch(r.length%4){default:case 0:return r;case 1:return r+"===";case 2:return r+"==";case 3:return r+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:a._decompress(t.length,32,(function(r){return o(e,t.charAt(r))}))},compressToUTF16:function(e){return null==e?"":a._compress(e,15,(function(e){return t(e+32)}))+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:a._decompress(t.length,16384,(function(e){return t.charCodeAt(e)-32}))},compressToUint8Array:function(t){for(var e=a.compress(t),r=new Uint8Array(2*e.length),n=0,o=e.length;n<o;n++){var i=e.charCodeAt(n);r[2*n]=i>>>8,r[2*n+1]=i%256}return r},decompressFromUint8Array:function(e){if(null==e)return a.decompress(e);for(var r=new Array(e.length/2),n=0,o=r.length;n<o;n++)r[n]=256*e[2*n]+e[2*n+1];var i=[];return r.forEach((function(e){i.push(t(e))})),a.decompress(i.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":a._compress(t,6,(function(t){return r.charAt(t)}))},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),a._decompress(t.length,32,(function(e){return o(r,t.charAt(e))})))},compress:function(e){return a._compress(e,16,(function(e){return t(e)}))},_compress:function(t,e,r){if(null==t)return"";var n,o,a,i={},c={},s="",u="",l="",f=2,p=3,h=2,d=[],y=0,v=0;for(a=0;a<t.length;a+=1)if(s=t.charAt(a),Object.prototype.hasOwnProperty.call(i,s)||(i[s]=p++,c[s]=!0),u=l+s,Object.prototype.hasOwnProperty.call(i,u))l=u;else{if(Object.prototype.hasOwnProperty.call(c,l)){if(l.charCodeAt(0)<256){for(n=0;n<h;n++)y<<=1,v==e-1?(v=0,d.push(r(y)),y=0):v++;for(o=l.charCodeAt(0),n=0;n<8;n++)y=y<<1|1&o,v==e-1?(v=0,d.push(r(y)),y=0):v++,o>>=1}else{for(o=1,n=0;n<h;n++)y=y<<1|o,v==e-1?(v=0,d.push(r(y)),y=0):v++,o=0;for(o=l.charCodeAt(0),n=0;n<16;n++)y=y<<1|1&o,v==e-1?(v=0,d.push(r(y)),y=0):v++,o>>=1}0==--f&&(f=Math.pow(2,h),h++),delete c[l]}else for(o=i[l],n=0;n<h;n++)y=y<<1|1&o,v==e-1?(v=0,d.push(r(y)),y=0):v++,o>>=1;0==--f&&(f=Math.pow(2,h),h++),i[u]=p++,l=String(s)}if(""!==l){if(Object.prototype.hasOwnProperty.call(c,l)){if(l.charCodeAt(0)<256){for(n=0;n<h;n++)y<<=1,v==e-1?(v=0,d.push(r(y)),y=0):v++;for(o=l.charCodeAt(0),n=0;n<8;n++)y=y<<1|1&o,v==e-1?(v=0,d.push(r(y)),y=0):v++,o>>=1}else{for(o=1,n=0;n<h;n++)y=y<<1|o,v==e-1?(v=0,d.push(r(y)),y=0):v++,o=0;for(o=l.charCodeAt(0),n=0;n<16;n++)y=y<<1|1&o,v==e-1?(v=0,d.push(r(y)),y=0):v++,o>>=1}0==--f&&(f=Math.pow(2,h),h++),delete c[l]}else for(o=i[l],n=0;n<h;n++)y=y<<1|1&o,v==e-1?(v=0,d.push(r(y)),y=0):v++,o>>=1;0==--f&&(f=Math.pow(2,h),h++)}for(o=2,n=0;n<h;n++)y=y<<1|1&o,v==e-1?(v=0,d.push(r(y)),y=0):v++,o>>=1;for(;;){if(y<<=1,v==e-1){d.push(r(y));break}v++}return d.join("")},decompress:function(t){return null==t?"":""==t?null:a._decompress(t.length,32768,(function(e){return t.charCodeAt(e)}))},_decompress:function(e,r,n){var o,a,i,c,s,u,l,f=[],p=4,h=4,d=3,y="",v=[],g={val:n(0),position:r,index:1};for(o=0;o<3;o+=1)f[o]=o;for(i=0,s=Math.pow(2,2),u=1;u!=s;)c=g.val&g.position,g.position>>=1,0==g.position&&(g.position=r,g.val=n(g.index++)),i|=(c>0?1:0)*u,u<<=1;switch(i){case 0:for(i=0,s=Math.pow(2,8),u=1;u!=s;)c=g.val&g.position,g.position>>=1,0==g.position&&(g.position=r,g.val=n(g.index++)),i|=(c>0?1:0)*u,u<<=1;l=t(i);break;case 1:for(i=0,s=Math.pow(2,16),u=1;u!=s;)c=g.val&g.position,g.position>>=1,0==g.position&&(g.position=r,g.val=n(g.index++)),i|=(c>0?1:0)*u,u<<=1;l=t(i);break;case 2:return""}for(f[3]=l,a=l,v.push(l);;){if(g.index>e)return"";for(i=0,s=Math.pow(2,d),u=1;u!=s;)c=g.val&g.position,g.position>>=1,0==g.position&&(g.position=r,g.val=n(g.index++)),i|=(c>0?1:0)*u,u<<=1;switch(l=i){case 0:for(i=0,s=Math.pow(2,8),u=1;u!=s;)c=g.val&g.position,g.position>>=1,0==g.position&&(g.position=r,g.val=n(g.index++)),i|=(c>0?1:0)*u,u<<=1;f[h++]=t(i),l=h-1,p--;break;case 1:for(i=0,s=Math.pow(2,16),u=1;u!=s;)c=g.val&g.position,g.position>>=1,0==g.position&&(g.position=r,g.val=n(g.index++)),i|=(c>0?1:0)*u,u<<=1;f[h++]=t(i),l=h-1,p--;break;case 2:return v.join("")}if(0==p&&(p=Math.pow(2,d),d++),f[l])y=f[l];else{if(l!==h)return null;y=a+a.charAt(0)}v.push(y),f[h++]=a+y.charAt(0),a=y,0==--p&&(p=Math.pow(2,d),d++)}}};return a}();void 0===(n=function(){return o}.call(e,r,e,t))||(t.exports=n)}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var a=e[n]={exports:{}};return t[n](a,a.exports,r),a.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=r(992),e=r.n(t);function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,a(n.key),n)}}function a(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}const i=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},(r=[{key:"compress",value:function(t){var r="object"===n(t)?JSON.stringify(t):String(t);return e().compressToUTF16(r)}},{key:"decompress",value:function(t){var r=e().decompressFromUTF16(t);if(!r)return null;try{return JSON.parse(r)}catch(t){return r}}},{key:"compressToBase64",value:function(t){var r="object"===n(t)?JSON.stringify(t):String(t);return e().compressToBase64(r)}},{key:"decompressFromBase64",value:function(t){var r=e().decompressFromBase64(t);if(!r)return null;try{return JSON.parse(r)}catch(t){return r}}}])&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r}();function c(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function l(){l=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var a=e&&e.prototype instanceof m?e:m,i=Object.create(a.prototype),c=new _(n||[]);return o(i,"_invoke",{value:T(t,r,c)}),i}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",g="completed",b={};function m(){}function w(){}function x(){}var k={};f(k,i,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(I([])));O&&O!==r&&n.call(O,i)&&(k=O);var L=x.prototype=m.prototype=Object.create(k);function S(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=h(t[o],t,a);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==u(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(f).then((function(t){l.value=t,i(l)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function T(e,r,n){var o=d;return function(a,i){if(o===v)throw Error("Generator is already running");if(o===g){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=P(c,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var u=h(e,r,n);if("normal"===u.type){if(o=n.done?g:y,u.arg===b)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=g,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var a=h(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,b;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function G(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(G,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(u(e)+" is not iterable")}return w.prototype=x,o(L,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},S(j.prototype),f(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(p(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},S(L),f(L,s,"Generator"),f(L,i,(function(){return this})),f(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,b):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function f(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function p(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){f(a,n,o,i,c,"next",t)}function c(t){f(a,n,o,i,c,"throw",t)}i(void 0)}))}}function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,d(n.key),n)}}function d(t){var e=function(t){if("object"!=u(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(e)?e:e+""}const y=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.password=e,this.algorithm={name:"AES-GCM",length:256},this.ivLength=12,this.saltLength=16,this.iterations=1e5,this.cryptoObj=globalThis.crypto},e=[{key:"setPassword",value:function(t){this.password=t}},{key:"deriveKey",value:(s=p(l().mark((function t(e,r){var n,o;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new TextEncoder,t.next=3,this.cryptoObj.subtle.importKey("raw",n.encode(e),{name:"PBKDF2"},!1,["deriveBits","deriveKey"]);case 3:return o=t.sent,t.abrupt("return",this.cryptoObj.subtle.deriveKey({name:"PBKDF2",salt:r,iterations:this.iterations,hash:"SHA-256"},o,this.algorithm,!1,["encrypt","decrypt"]));case 5:case"end":return t.stop()}}),t,this)}))),function(t,e){return s.apply(this,arguments)})},{key:"generateKey",value:(i=p(l().mark((function t(){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.cryptoObj.subtle.generateKey(this.algorithm,!0,["encrypt","decrypt"]));case 1:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"exportKey",value:(a=p(l().mark((function t(e){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.cryptoObj.subtle.exportKey("raw",e));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"importKey",value:(o=p(l().mark((function t(e){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.cryptoObj.subtle.importKey("raw",e,this.algorithm,!1,["encrypt","decrypt"]));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"encrypt",value:(n=p(l().mark((function t(e){var r,n,o,a,i,s,f,p,h,d=arguments;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=(d.length>1&&void 0!==d[1]?d[1]:null)||this.password){t.next=4;break}throw new Error("No password set for encryption");case 4:return n=this.cryptoObj.getRandomValues(new Uint8Array(this.saltLength)),o=this.cryptoObj.getRandomValues(new Uint8Array(this.ivLength)),t.next=8,this.deriveKey(r,n);case 8:return a=t.sent,i=new TextEncoder,s="object"===u(e)?JSON.stringify(e):String(e),f=i.encode(s),t.next=14,this.cryptoObj.subtle.encrypt({name:"AES-GCM",iv:o},a,f);case 14:return p=t.sent,(h=new Uint8Array(n.length+o.length+p.byteLength)).set(n,0),h.set(o,n.length),h.set(new Uint8Array(p),n.length+o.length),t.abrupt("return",btoa(String.fromCharCode.apply(String,c(h))));case 20:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"decrypt",value:(r=p(l().mark((function t(e){var r,n,o,a,i,c,s,u,f,p=arguments;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=(p.length>1&&void 0!==p[1]?p[1]:null)||this.password){t.next=4;break}throw new Error("No password set for decryption");case 4:if(t.prev=4,e&&"string"==typeof e){t.next=7;break}throw new Error("Invalid encrypted data format");case 7:t.prev=7,n=Uint8Array.from(atob(e),(function(t){return t.charCodeAt(0)})),t.next=15;break;case 11:throw t.prev=11,t.t0=t.catch(7),console.error("Error decoding Base64:",t.t0),new Error("Invalid Base64 data format");case 15:if(!(n.length<=this.saltLength+this.ivLength)){t.next=17;break}throw new Error("Encrypted data is too short");case 17:return o=n.slice(0,this.saltLength),a=n.slice(this.saltLength,this.saltLength+this.ivLength),i=n.slice(this.saltLength+this.ivLength),t.next=22,this.deriveKey(r,o);case 22:return c=t.sent,t.prev=23,t.next=26,this.cryptoObj.subtle.decrypt({name:"AES-GCM",iv:a},c,i);case 26:return s=t.sent,u=new TextDecoder,f=u.decode(s),t.prev=29,t.abrupt("return",JSON.parse(f));case 33:return t.prev=33,t.t1=t.catch(29),t.abrupt("return",f);case 36:t.next=42;break;case 38:throw t.prev=38,t.t2=t.catch(23),console.error("WebCrypto decryption failed:",t.t2),new Error("Decryption failed: Incorrect password or corrupted data");case 42:t.next=48;break;case 44:throw t.prev=44,t.t3=t.catch(4),console.error("Decryption error:",t.t3),t.t3;case 48:case"end":return t.stop()}}),t,this,[[4,44],[7,11],[23,38],[29,33]])}))),function(t){return r.apply(this,arguments)})}],e&&h(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,a,i,s}();function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function g(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return b(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return i=t.done,t},e:function(t){c=!0,a=t},f:function(){try{i||null==r.return||r.return()}finally{if(c)throw a}}}}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function m(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function w(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?m(Object(r),!0).forEach((function(e){x(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function x(t,e,r){return(e=S(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function k(){k=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof b?e:b,i=Object.create(a.prototype),c=new _(n||[]);return o(i,"_invoke",{value:T(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",g={};function b(){}function m(){}function w(){}var x={};u(x,i,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(I([])));O&&O!==r&&n.call(O,i)&&(x=O);var L=w.prototype=b.prototype=Object.create(x);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,a,i,c){var s=f(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==v(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function T(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=P(c,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,g;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function G(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(G,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(v(e)+" is not iterable")}return m.prototype=w,o(L,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=u(w,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},S(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new j(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},S(L),u(L,s,"Generator"),u(L,i,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function E(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function O(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){E(a,n,o,i,c,"next",t)}function c(t){E(a,n,o,i,c,"throw",t)}i(void 0)}))}}function L(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,S(n.key),n)}}function S(t){var e=function(t){if("object"!=v(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=v(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==v(e)?e:e+""}const j=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dbName="TabLockerDB",this.dbVersion=3,this.db=null,this.isReady=!1,this.compressionService=new i,this.encryptionService=new y(e),this.initializeDB()},e=[{key:"setPassword",value:function(t){this.encryptionService.setPassword(t)}},{key:"initializeDB",value:(T=O(k().mark((function t(){var e=this;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){var n=indexedDB.open(e.dbName,e.dbVersion);n.onupgradeneeded=function(t){var e=t.target.result,r=t.oldVersion;if(!e.objectStoreNames.contains("tabGroups")){var o=e.createObjectStore("tabGroups",{keyPath:"id"});o.createIndex("created","created",{unique:!1}),o.createIndex("name","name",{unique:!1}),o.createIndex("orderIndex","orderIndex",{unique:!1})}if(e.objectStoreNames.contains("settings")||e.createObjectStore("settings",{keyPath:"key"}),r<3){if(!e.objectStoreNames.contains("tags")){var a=e.createObjectStore("tags",{keyPath:"id"});a.createIndex("name","name",{unique:!0}),a.createIndex("created","created",{unique:!1})}var i=n.transaction.objectStore("tabGroups");i.indexNames.contains("tags")||i.createIndex("tags","tags",{unique:!1,multiEntry:!0})}},n.onsuccess=function(r){e.db=r.target.result,e.isReady=!0,t(e.db)},n.onerror=function(t){console.error("Error opening IndexedDB:",t.target.error),r(t.target.error)}})));case 1:case"end":return t.stop()}}),t)}))),function(){return T.apply(this,arguments)})},{key:"ensureDBReady",value:(j=O(k().mark((function t(){return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isReady||!this.db){t.next=2;break}return t.abrupt("return",this.db);case 2:return t.abrupt("return",this.initializeDB());case 3:case"end":return t.stop()}}),t,this)}))),function(){return j.apply(this,arguments)})},{key:"transaction",value:(S=O(k().mark((function t(e,r,n){var o=this;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.ensureDBReady();case 2:return t.abrupt("return",new Promise((function(t,a){var i=o.db.transaction(e,r),c=i.objectStore(e);i.oncomplete=function(){return t()},i.onerror=function(t){return a(t.target.error)};var s=n(c);s&&(s.onsuccess=function(e){return t(e.target.result)},s.onerror=function(t){return a(t.target.error)})})));case 3:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return S.apply(this,arguments)})},{key:"saveTabGroup",value:(E=O(k().mark((function t(e){var r,n,o,a;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.id||(e.id=crypto.randomUUID()),e.created||(e.created=Date.now()),e.name||(e.name="Tabs from ".concat(new Date(e.created).toLocaleString())),(r=JSON.parse(JSON.stringify(e))).tabs&&Array.isArray(r.tabs)){t.next=8;break}throw console.error("No tabs array found in tab group:",r),new Error("No tabs to save");case 8:if(n=JSON.stringify(r.tabs),o=this.compressionService.compress(n),this.encryptionService.password){t.next=19;break}return t.next=13,chrome.storage.local.get("password");case 13:if(!(a=t.sent).password){t.next=18;break}this.setPassword(a.password),t.next=19;break;case 18:throw new Error("No password set for encryption");case 19:return t.next=21,this.encryptionService.encrypt(o);case 21:return r.encryptedTabs=t.sent,delete r.tabs,t.next=25,this.transaction("tabGroups","readwrite",(function(t){return t.put(r)}));case 25:return console.log("Successfully saved tab group with ID: ".concat(r.id),r),t.abrupt("return",r.id);case 29:throw t.prev=29,t.t0=t.catch(0),console.error("Error saving tab group:",t.t0),new Error("Failed to save tabs: ".concat(t.t0.message));case 33:case"end":return t.stop()}}),t,this,[[0,29]])}))),function(t){return E.apply(this,arguments)})},{key:"getTabGroup",value:(x=O(k().mark((function t(e){var r,n,o,a;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.transaction("tabGroups","readonly",(function(t){return t.get(e)}));case 3:if(r=t.sent){t.next=6;break}return t.abrupt("return",null);case 6:if(this.encryptionService.password){t.next=15;break}return t.next=9,chrome.storage.local.get("password");case 9:if(!(n=t.sent).password){t.next=14;break}this.setPassword(n.password),t.next=15;break;case 14:throw new Error("No password set for decryption");case 15:if(!r.encryptedTabs){t.next=46;break}return t.prev=16,t.next=19,this.encryptionService.decrypt(r.encryptedTabs);case 19:if(o=t.sent){t.next=22;break}throw new Error("Failed to decrypt tab data");case 22:if(a=this.compressionService.decompress(o)){t.next=25;break}throw new Error("Failed to decompress tab data");case 25:if("string"!=typeof a){t.next=36;break}t.prev=26,r.tabs=JSON.parse(a),t.next=34;break;case 30:throw t.prev=30,t.t0=t.catch(26),console.error("Error parsing decompressed tabs:",t.t0),new Error("Invalid tab data format");case 34:t.next=37;break;case 36:r.tabs=a;case 37:return t.abrupt("return",r);case 40:throw t.prev=40,t.t1=t.catch(16),console.error("Error decrypting tab group:",t.t1),new Error("Unable to decrypt tab group: ".concat(t.t1.message));case 44:t.next=47;break;case 46:throw new Error("No encrypted tab data found");case 47:t.next=53;break;case 49:throw t.prev=49,t.t2=t.catch(0),console.error("Error retrieving tab group:",t.t2),new Error("Failed to retrieve tab group: ".concat(t.t2.message));case 53:case"end":return t.stop()}}),t,this,[[0,49],[16,40],[26,30]])}))),function(t){return x.apply(this,arguments)})},{key:"getAllTabGroups",value:(m=O(k().mark((function t(){var e=this;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=O(k().mark((function t(r,n){var o,a,i,c;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ensureDBReady();case 2:o=e.db.transaction("tabGroups","readonly"),a=o.objectStore("tabGroups"),i=a.index("created").openCursor(null,"prev"),c=[],i.onsuccess=function(t){var e=t.target.result;if(e){var n=w({},e.value);delete n.encryptedTabs,c.push(n),e.continue()}else{var o=c.sort((function(t,e){return void 0!==t.orderIndex&&void 0!==e.orderIndex?t.orderIndex-e.orderIndex:void 0!==t.orderIndex?-1:void 0!==e.orderIndex?1:e.created-t.created}));r(o)}},i.onerror=function(t){n(t.target.error)};case 8:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t)}))),function(){return m.apply(this,arguments)})},{key:"deleteTabGroup",value:(b=O(k().mark((function t(e){return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.transaction("tabGroups","readwrite",(function(t){return t.delete(e)})));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return b.apply(this,arguments)})},{key:"updateTabGroup",value:(v=O(k().mark((function t(e,r){var n;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getTabGroup(e);case 2:if(n=t.sent){t.next=5;break}throw new Error("Tab group not found");case 5:return Object.assign(n,r),t.abrupt("return",this.saveTabGroup(n));case 7:case"end":return t.stop()}}),t,this)}))),function(t,e){return v.apply(this,arguments)})},{key:"searchTabGroups",value:(d=O(k().mark((function t(e){var r,n,o,a,i,c,s,u,l,f,p,h,d,y,v,b,m,x,E,O,L,S,j,T,P,G,A,_,I,N;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("=== SEARCH DEBUG START ==="),console.log('Raw search query: "'.concat(e,'"')),e&&""!==e.trim()){t.next=5;break}return console.log("Empty query - returning all tab groups"),t.abrupt("return",this.getAllTabGroups());case 5:return t.next=7,this.getAllTabGroups();case 7:r=t.sent,console.log("Total groups to search: ".concat(r.length)),r.length>0&&console.log("Sample group structure:",JSON.stringify(r[0],null,2)),n=e.toLowerCase().trim(),console.log('Normalized search query: "'.concat(n,'"')),o=[],a=g(r);try{for(a.s();!(i=a.n()).done;)c=i.value,s=!1,u="",c.name&&-1!==c.name.toLowerCase().indexOf(n)&&(s=!0,u='Group name match: "'.concat(c.name,'" contains "').concat(n,'"')),!s&&c.created&&(l=new Date(c.created).toLocaleString().toLowerCase(),console.log("Group ".concat(c.id,' date string: "').concat(l,'"')),-1!==l.indexOf(n)&&(s=!0,u='Date/time match: "'.concat(l,'" contains "').concat(n,'"'))),s?(o.push(w(w({},c),{},{tabCount:c.tabCount||0,_matchReason:u,matchInfo:{field:c.name&&-1!==c.name.toLowerCase().indexOf(n)?"name":"date",text:c.name&&-1!==c.name.toLowerCase().indexOf(n)?c.name:new Date(c.created).toLocaleString(),query:n}})),console.log("✓ Metadata match for group ".concat(c.id,": ").concat(u))):console.log("✗ No metadata match for group ".concat(c.id))}catch(t){a.e(t)}finally{a.f()}console.log("Metadata matches found: ".concat(o.length)),f=r.filter((function(t){return!o.some((function(e){return e.id===t.id}))})).map((function(t){return t.id})),console.log("Groups to search in tab content: ".concat(f.length)),p=[],h=g(f),t.prev=20,h.s();case 22:if((d=h.n()).done){t.next=98;break}return y=d.value,t.prev=24,console.log("Searching inside tab content for group ".concat(y,"...")),t.next=28,this.getTabGroup(y);case 28:if(v=t.sent){t.next=32;break}return console.log("Group ".concat(y," not found")),t.abrupt("continue",96);case 32:if(v.tabs){t.next=35;break}return console.log("Group ".concat(y," has no tabs array")),t.abrupt("continue",96);case 35:console.log("Group ".concat(y," has ").concat(v.tabs.length," tabs to search")),b=v.tabs.length,m=!1,x="",E=0;case 40:if(!(E<v.tabs.length)){t.next=60;break}if(!(O=v.tabs[E]).title||-1===O.title.toLowerCase().indexOf(n)){t.next=46;break}return m=!0,x="Tab ".concat(E,' title match: "').concat(O.title,'" contains "').concat(n,'"'),t.abrupt("break",60);case 46:if(!O.url||-1===O.url.toLowerCase().indexOf(n)){t.next=50;break}return m=!0,x="Tab ".concat(E,' URL match: "').concat(O.url,'" contains "').concat(n,'"'),t.abrupt("break",60);case 50:if(!O.savedAt){t.next=57;break}if(L=new Date(O.savedAt).toLocaleString().toLowerCase(),console.log("Tab ".concat(E,' date string: "').concat(L,'"')),-1===L.indexOf(n)){t.next=57;break}return m=!0,x="Tab ".concat(E,' date match: "').concat(L,'" contains "').concat(n,'"'),t.abrupt("break",60);case 57:E++,t.next=40;break;case 60:if(!m){t.next=90;break}S="",j="",T=0;case 64:if(!(T<v.tabs.length)){t.next=85;break}if(!(P=v.tabs[T]).title||-1===P.title.toLowerCase().indexOf(n)){t.next=72;break}return S="title",j=P.title,t.abrupt("break",85);case 72:if(!P.url||-1===P.url.toLowerCase().indexOf(n)){t.next=78;break}return S="url",j=P.url,t.abrupt("break",85);case 78:if(!P.savedAt||-1===new Date(P.savedAt).toLocaleString().toLowerCase().indexOf(n)){t.next=82;break}return S="date",j=new Date(P.savedAt).toLocaleString(),t.abrupt("break",85);case 82:T++,t.next=64;break;case 85:G={id:v.id,name:v.name,created:v.created,orderIndex:v.orderIndex,tabCount:b,_matchReason:x,matchInfo:{field:S,text:j,query:n}},p.push(G),console.log("✓ Content match for group ".concat(y,": ").concat(x)),t.next=91;break;case 90:console.log("✗ No content match for group ".concat(y));case 91:t.next=96;break;case 93:t.prev=93,t.t0=t.catch(24),console.error("Error searching tab group ".concat(y,":"),t.t0);case 96:t.next=22;break;case 98:t.next=103;break;case 100:t.prev=100,t.t1=t.catch(20),h.e(t.t1);case 103:return t.prev=103,h.f(),t.finish(103);case 106:console.log("Content matches found: ".concat(p.length)),A=[].concat(o),_=k().mark((function t(){var e;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=N[I],A.some((function(t){return t.id===e.id}))||A.push(e);case 2:case"end":return t.stop()}}),t)})),I=0,N=p;case 110:if(!(I<N.length)){t.next=115;break}return t.delegateYield(_(),"t2",112);case 112:I++,t.next=110;break;case 115:return console.log("Total matches after deduplication: ".concat(A.length)),console.log("Search results:",A),console.log("=== SEARCH DEBUG END ==="),t.abrupt("return",A);case 119:case"end":return t.stop()}}),t,this,[[20,100,103,106],[24,93]])}))),function(t){return d.apply(this,arguments)})},{key:"saveSetting",value:(h=O(k().mark((function t(e,r){return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.transaction("settings","readwrite",(function(t){return t.put({key:e,value:r})})));case 1:case"end":return t.stop()}}),t,this)}))),function(t,e){return h.apply(this,arguments)})},{key:"getSetting",value:(p=O(k().mark((function t(e){var r;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.transaction("settings","readonly",(function(t){return t.get(e)}));case 2:return r=t.sent,t.abrupt("return",r?r.value:null);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return p.apply(this,arguments)})},{key:"clearAllData",value:(f=O(k().mark((function t(){var e;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.ensureDBReady();case 2:return(e=this.db.transaction(["tabGroups","settings","tags"],"readwrite")).objectStore("tabGroups").clear(),e.objectStore("settings").clear(),e.objectStore("tags").clear(),t.abrupt("return",new Promise((function(t,r){e.oncomplete=function(){return t()},e.onerror=function(t){return r(t.target.error)}})));case 7:case"end":return t.stop()}}),t,this)}))),function(){return f.apply(this,arguments)})},{key:"createTag",value:(l=O(k().mark((function t(e){var r;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.id||(e.id=crypto.randomUUID()),e.created||(e.created=Date.now()),e.name&&"string"==typeof e.name&&""!==e.name.trim()){t.next=5;break}throw new Error("Tag must have a valid name");case 5:return r={id:e.id,name:e.name.trim(),created:e.created,color:e.color||null},t.next=8,this.transaction("tags","readwrite",(function(t){return t.put(r)}));case 8:return console.log("Successfully created tag with ID: ".concat(r.id),r),t.abrupt("return",r.id);case 12:throw t.prev=12,t.t0=t.catch(0),console.error("Error creating tag:",t.t0),new Error("Failed to create tag: ".concat(t.t0.message));case 16:case"end":return t.stop()}}),t,this,[[0,12]])}))),function(t){return l.apply(this,arguments)})},{key:"getAllTags",value:(u=O(k().mark((function t(){var e=this;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=O(k().mark((function t(r,n){var o,a,i,c;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ensureDBReady();case 2:o=e.db.transaction("tags","readonly"),a=o.objectStore("tags"),i=a.index("name").openCursor(),c=[],i.onsuccess=function(t){var e=t.target.result;e?(c.push(e.value),e.continue()):r(c)},i.onerror=function(t){n(t.target.error)};case 8:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t)}))),function(){return u.apply(this,arguments)})},{key:"getTag",value:(s=O(k().mark((function t(e){return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.transaction("tags","readonly",(function(t){return t.get(e)})));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)})},{key:"updateTag",value:(c=O(k().mark((function t(e,r){var n,o;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getTag(e);case 2:if(n=t.sent){t.next=5;break}throw new Error("Tag not found");case 5:if(!r.name||"string"==typeof r.name&&""!==r.name.trim()){t.next=7;break}throw new Error("Tag name cannot be empty");case 7:return o=w(w({},n),r),r.name&&(o.name=r.name.trim()),t.abrupt("return",this.transaction("tags","readwrite",(function(t){return t.put(o)})));case 10:case"end":return t.stop()}}),t,this)}))),function(t,e){return c.apply(this,arguments)})},{key:"deleteTag",value:(a=O(k().mark((function t(e){var r,n,o,a,i;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.getAllTabGroups();case 3:r=t.sent,n=g(r),t.prev=5,n.s();case 7:if((o=n.n()).done){t.next=18;break}if(!(a=o.value).tags||!a.tags.includes(e)){t.next=16;break}return t.next=12,this.getTabGroup(a.id);case 12:return(i=t.sent).tags=i.tags.filter((function(t){return t!==e})),t.next=16,this.saveTabGroup(i);case 16:t.next=7;break;case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(5),n.e(t.t0);case 23:return t.prev=23,n.f(),t.finish(23);case 26:return t.abrupt("return",this.transaction("tags","readwrite",(function(t){return t.delete(e)})));case 29:throw t.prev=29,t.t1=t.catch(0),console.error("Error deleting tag:",t.t1),new Error("Failed to delete tag: ".concat(t.t1.message));case 33:case"end":return t.stop()}}),t,this,[[0,29],[5,20,23,26]])}))),function(t){return a.apply(this,arguments)})},{key:"addTagsToGroup",value:(o=O(k().mark((function t(e,r){var n,o,a,i,c,s,u,l,f;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,n=Array.isArray(r)?r:[r],o=g(n),t.prev=3,o.s();case 5:if((a=o.n()).done){t.next=14;break}return i=a.value,t.next=9,this.getTag(i);case 9:if(t.sent){t.next=12;break}throw new Error("Tag with ID ".concat(i," does not exist"));case 12:t.next=5;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(3),o.e(t.t0);case 19:return t.prev=19,o.f(),t.finish(19);case 22:return t.next=24,this.getTabGroup(e);case 24:if(c=t.sent){t.next=27;break}throw new Error("Tab group with ID ".concat(e," not found"));case 27:c.tags||(c.tags=[]),s=!1,u=g(n);try{for(u.s();!(l=u.n()).done;)f=l.value,c.tags.includes(f)||(c.tags.push(f),s=!0)}catch(t){u.e(t)}finally{u.f()}if(!s){t.next=34;break}return t.next=34,this.saveTabGroup(c);case 34:return t.abrupt("return",c.tags);case 37:throw t.prev=37,t.t1=t.catch(0),console.error("Error adding tags to group:",t.t1),new Error("Failed to add tags: ".concat(t.t1.message));case 41:case"end":return t.stop()}}),t,this,[[0,37],[3,16,19,22]])}))),function(t,e){return o.apply(this,arguments)})},{key:"removeTagsFromGroup",value:(n=O(k().mark((function t(e,r){var n,o,a;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=Array.isArray(r)?r:[r],t.next=4,this.getTabGroup(e);case 4:if(o=t.sent){t.next=7;break}throw new Error("Tab group with ID ".concat(e," not found"));case 7:if(o.tags&&0!==o.tags.length){t.next=9;break}return t.abrupt("return",[]);case 9:if(a=o.tags.length,o.tags=o.tags.filter((function(t){return!n.includes(t)})),o.tags.length===a){t.next=14;break}return t.next=14,this.saveTabGroup(o);case 14:return t.abrupt("return",o.tags);case 17:throw t.prev=17,t.t0=t.catch(0),console.error("Error removing tags from group:",t.t0),new Error("Failed to remove tags: ".concat(t.t0.message));case 21:case"end":return t.stop()}}),t,this,[[0,17]])}))),function(t,e){return n.apply(this,arguments)})},{key:"getGroupsByTags",value:(r=O(k().mark((function t(e){var r,n;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Array.isArray(e)?e:[e],t.next=3,this.getAllTabGroups();case 3:return n=t.sent,t.abrupt("return",n.filter((function(t){return!!t.tags&&r.every((function(e){return t.tags.includes(e)}))})));case 5:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})}],e&&L(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,a,c,s,u,l,f,p,h,d,v,b,m,x,E,S,j,T}();function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}function P(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function G(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?P(Object(r),!0).forEach((function(e){A(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function A(t,e,r){return(e=C(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _(){_=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof g?e:g,i=Object.create(a.prototype),c=new A(n||[]);return o(i,"_invoke",{value:S(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function g(){}function b(){}function m(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(I([])));k&&k!==r&&n.call(k,i)&&(w=k);var E=m.prototype=g.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(o,a,i,c){var s=f(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==T(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function S(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=j(c,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function G(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function I(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(T(e)+" is not iterable")}return b.prototype=m,o(E,"constructor",{value:m,configurable:!0}),o(m,"constructor",{value:b,configurable:!0}),b.displayName=u(m,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(L.prototype),u(L.prototype,c,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new L(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},O(E),u(E,s,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=I,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(G),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),G(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;G(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:I(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function I(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function N(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){I(a,n,o,i,c,"next",t)}function c(t){I(a,n,o,i,c,"throw",t)}i(void 0)}))}}function D(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,C(n.key),n)}}function C(t){var e=function(t){if("object"!=T(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=T(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==T(e)?e:e+""}function F(t){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F(t)}function U(){U=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var a=e&&e.prototype instanceof g?e:g,i=Object.create(a.prototype),c=new G(n||[]);return o(i,"_invoke",{value:S(t,r,c)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function g(){}function b(){}function m(){}var w={};u(w,i,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(A([])));k&&k!==r&&n.call(k,i)&&(w=k);var E=m.prototype=g.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(o,a,i,c){var s=f(t[o],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==F(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(s.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function S(e,r,n){var o=p;return function(a,i){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===a)throw i;return{value:t,done:!0}}for(n.method=a,n.arg=i;;){var c=n.delegate;if(c){var s=j(c,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?y:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var a=f(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,v;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function G(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(F(e)+" is not iterable")}return b.prototype=m,o(E,"constructor",{value:m,configurable:!0}),o(m,"constructor",{value:b,configurable:!0}),b.displayName=u(m,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(L.prototype),u(L.prototype,c,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new L(l(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},O(E),u(E,s,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,G.prototype={constructor:G,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),P(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function B(t,e,r,n,o,a,i){try{var c=t[a](i),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function M(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){B(a,n,o,i,c,"next",t)}function c(t){B(a,n,o,i,c,"throw",t)}i(void 0)}))}}var R=null,q=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"getCurrentWindowTabs",value:(s=N(_().mark((function t(){return _().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){chrome.tabs.query({currentWindow:!0},(function(e){var r=e.filter((function(t){return!(t.url.startsWith("chrome-extension://")||t.url.startsWith("moz-extension://")||t.url.startsWith("edge-extension://")||t.url.startsWith("opera-extension://"))})).map((function(t){return{id:t.id,url:t.url,title:t.title,favIconUrl:t.favIconUrl||null,pinned:t.pinned||!1,groupId:void 0!==t.groupId?t.groupId:-1}}));t(r)}))})));case 1:case"end":return t.stop()}}),t)}))),function(){return s.apply(this,arguments)})},{key:"getAllWindowsTabs",value:(c=N(_().mark((function t(){return _().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){chrome.tabs.query({},(function(e){var r=e.reduce((function(t,e){return e.url.startsWith("chrome-extension://")||e.url.startsWith("moz-extension://")||e.url.startsWith("edge-extension://")||e.url.startsWith("opera-extension://")||(t[e.windowId]||(t[e.windowId]=[]),t[e.windowId].push({id:e.id,url:e.url,title:e.title,favIconUrl:e.favIconUrl||null,pinned:e.pinned||!1,groupId:void 0!==e.groupId?e.groupId:-1})),t}),{});t(Object.values(r))}))})));case 1:case"end":return t.stop()}}),t)}))),function(){return c.apply(this,arguments)})},{key:"getTabGroups",value:(i=N(_().mark((function t(){return _().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(chrome.tabGroups){t.next=2;break}return t.abrupt("return",{});case 2:return t.abrupt("return",new Promise((function(t){chrome.tabGroups.query({},(function(e){var r=e.reduce((function(t,e){return t[e.id]={name:e.title||"",color:e.color||"grey"},t}),{});t(r)}))})));case 3:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"closeTabs",value:(a=N(_().mark((function t(e){return _().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){chrome.tabs.remove(e,(function(){t()}))})));case 1:case"end":return t.stop()}}),t)}))),function(t){return a.apply(this,arguments)})},{key:"createTab",value:(o=N(_().mark((function t(e){var r,n=arguments;return _().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=!(n.length>1&&void 0!==n[1])||n[1],t.abrupt("return",new Promise((function(t){chrome.tabs.create({url:e,active:r},(function(e){t(e)}))})));case 2:case"end":return t.stop()}}),t)}))),function(t){return o.apply(this,arguments)})},{key:"restoreTabs",value:(n=N(_().mark((function t(e){var r,n,o,a,i;return _().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=[],n=0;case 3:if(!(n<e.length)){t.next=13;break}return o=e[n],a=0===n,t.next=8,this.createTab(o.url,a);case 8:i=t.sent,r.push(i);case 10:n++,t.next=3;break;case 13:return t.abrupt("return",r);case 14:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"isTabPinned",value:(r=N(_().mark((function t(e){return _().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){chrome.tabs.get(e,(function(e){t(e.pinned||!1)}))})));case 1:case"end":return t.stop()}}),t)}))),function(t){return r.apply(this,arguments)})},{key:"formatTabForDisplay",value:function(t){var e="";try{e=new URL(t.url).hostname}catch(r){e=t.url}return G(G({},t),{},{domain:e,shortTitle:this.truncateString(t.title,50)})}},{key:"truncateString",value:function(t,e){return t?t.length<=e?t:t.substring(0,e)+"...":""}}],e&&D(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,a,i,c,s}()),K=!1;function W(){return J.apply(this,arguments)}function J(){return(J=M(U().mark((function t(){var e,r;return U().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!K){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,chrome.storage.local.get("password");case 5:if(e=t.sent,r=e.password||null){t.next=12;break}return r="default-"+crypto.randomUUID(),t.next=11,chrome.storage.local.set({password:r});case 11:console.log("Default encryption password created");case 12:R=new j(r),K=!0,console.log("TabLocker services initialized"),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(2),console.error("Error initializing TabLocker services:",t.t0);case 20:case"end":return t.stop()}}),t,null,[[2,17]])})))).apply(this,arguments)}function z(){return Y.apply(this,arguments)}function Y(){return(Y=M(U().mark((function t(){var e,r,n,o,a;return U().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,W();case 3:return t.next=5,q.getCurrentWindowTabs();case 5:if(0!==(e=t.sent).length){t.next=9;break}return console.log("No tabs to save"),t.abrupt("return");case 9:return t.next=11,q.getTabGroups();case 11:return r=t.sent,n={tabs:e,tabGroups:r,created:Date.now(),name:"Tabs from ".concat((new Date).toLocaleString())},t.next=15,R.saveTabGroup(n);case 15:return o=t.sent,console.log("Saved ".concat(e.length," tabs with ID: ").concat(o)),t.next=19,chrome.storage.local.get("closeTabsAfterSave");case 19:if(!t.sent.closeTabsAfterSave){t.next=24;break}return a=e.map((function(t){return t.id})),t.next=24,q.closeTabs(a);case 24:return t.abrupt("return",o);case 27:throw t.prev=27,t.t0=t.catch(0),console.error("Error saving tabs:",t.t0),t.t0;case 31:case"end":return t.stop()}}),t,null,[[0,27]])})))).apply(this,arguments)}chrome.action.onClicked.addListener(function(){var t=M(U().mark((function t(e){return U().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,z();case 3:chrome.runtime.openOptionsPage(),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error("Error handling browser action click:",t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()),chrome.runtime.onInstalled.addListener(function(){var t=M(U().mark((function t(e){var r;return U().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("install"!==e.reason){t.next=5;break}return r="default-"+crypto.randomUUID(),t.next=4,chrome.storage.local.set({closeTabsAfterSave:!1,usePinProtection:!1,autoBackup:!0,password:r});case 4:chrome.runtime.openOptionsPage();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),chrome.runtime.onMessage.addListener((function(t,e,r){return M(U().mark((function e(){var n,o,a,i,c,s,u;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,W();case 3:e.t0=t.action,e.next="saveTabs"===e.t0?6:"restoreTabs"===e.t0?11:"setPassword"===e.t0?17:"getOptions"===e.t0?26:"setOptions"===e.t0?31:"getTabGroup"===e.t0?36:52;break;case 6:return e.next=8,z();case 8:return n=e.sent,r({success:!0,groupId:n}),e.abrupt("break",53);case 11:return o=t.data,a=o.tabs,i=o.keepSaved,e.next=14,q.restoreTabs(a,i);case 14:return c=e.sent,r({success:!0,count:c.length}),e.abrupt("break",53);case 17:if(!R){e.next=24;break}return R.setPassword(t.password),e.next=21,chrome.storage.local.set({password:t.password});case 21:r({success:!0}),e.next=25;break;case 24:r({success:!1,error:"Storage service not initialized"});case 25:return e.abrupt("break",53);case 26:return e.next=28,chrome.storage.local.get(["closeTabsAfterSave","usePinProtection","autoBackup","password","pin"]);case 28:return s=e.sent,r({success:!0,options:s}),e.abrupt("break",53);case 31:return e.next=33,chrome.storage.local.set(t.options);case 33:return t.options.password&&R&&R.setPassword(t.options.password),r({success:!0}),e.abrupt("break",53);case 36:if(e.prev=36,R){e.next=39;break}throw new Error("Storage service not initialized");case 39:return e.next=41,R.getTabGroup(t.id);case 41:if(u=e.sent){e.next=44;break}throw new Error("Tab group with ID ".concat(t.id," not found"));case 44:r({success:!0,group:u}),e.next=51;break;case 47:e.prev=47,e.t1=e.catch(36),console.error("Error getting tab group ".concat(t.id,":"),e.t1),r({success:!1,error:e.t1.message});case 51:return e.abrupt("break",53);case 52:r({success:!1,error:"Unknown action"});case 53:e.next=59;break;case 55:e.prev=55,e.t2=e.catch(0),console.error("Error handling message ".concat(t.action,":"),e.t2),r({success:!1,error:e.t2.message});case 59:case"end":return e.stop()}}),e,null,[[0,55],[36,47]])})))(),!0})),W()})()})();